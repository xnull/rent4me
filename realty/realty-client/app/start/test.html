<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>

<input type="button" id="connect" value="Connect" onclick="connect()"/>
<input type="button" id="disconnect" value="Disconnect" onclick="disconnect()"/>

<div id="response"></div>
<div id="conversationDiv"></div>

<input type="text" id="message"/>
<button onclick="sendName()">Send name</button>
<script type="text/javascript" src="http://cdn.jsdelivr.net/sockjs/0.3.4/sockjs.min.js"></script>
<script type="text/javascript" src="https://raw.githubusercontent.com/jmesnil/stomp-websocket/master/lib/stomp.min.js"></script>
<script type="text/javascript">
    function setConnected(connected) {
        document.getElementById('connect').disabled = connected;
        document.getElementById('disconnect').disabled = !connected;
        document.getElementById('conversationDiv').style.visibility = connected ? 'visible' : 'hidden';
        document.getElementById('response').innerHTML = '';
    }

    function connect() {

        console.log('Websocket supported');
//            socket = new WebSocket('ws://192.168.1.203:8888/ws/messages');
        socket = new SockJS('http://192.168.1.203:8888/ws/messages');

        console.log('Connection attempted');

        socket.onopen = function(){
            console.log('Connection open!');
            setConnected(true);
        };

        socket.onclose = function(){
            console.log('Disconnecting connection');
        };

        socket.onmessage = function (evt)
        {
            var received_msg = evt.data;
            console.log(received_msg);
            console.log('message received!');
            showMessage(received_msg);
        };
    }

    function disconnect() {
        if(socket) {
            socket.close();
        }
        setConnected(false);
        console.log("Disconnected");
    }

    function sendName() {
        var message = document.getElementById('message').value;
        try {
            socket.send(JSON.stringify({'message': message}));
        } catch (e) {
//            connect();
//            sendName();
        }
    }

    function showMessage(message) {
        var response = document.getElementById('response');
        var p = document.createElement('p');
        p.style.wordWrap = 'break-word';
        p.appendChild(document.createTextNode(message));
        response.appendChild(p);
    }

</script>

</body>
</html>